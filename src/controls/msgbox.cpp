#include "msgbox.h"  

namespace player {
	CMessageBox::CMessageBox(QWidget *parent)
		: ShadowWindow(parent)
	{
		resize(300, 165);

		QVBoxLayout *main_layout = new QVBoxLayout(this);
		QHBoxLayout *title_layout = new QHBoxLayout(this);
		QHBoxLayout *center_layout = new QHBoxLayout(this);
		QHBoxLayout *bottom_layout = new QHBoxLayout(this);

		m_titleText = new QLabel(QStringLiteral("提示"), this);
		m_titleIcon = new QLabel(this);
		m_closeBtn = new CustomPushButton(this);
		m_okBtn = new QPushButton(QStringLiteral("确定"), this);
		m_okBtn->setCursor(Qt::PointingHandCursor);
		m_cancelBtn = new QPushButton(QStringLiteral("取消"), this);
		m_cancelBtn->setCursor(Qt::PointingHandCursor);

		QPixmap titleIcon(":/player/logo");
		m_titleIcon->setPixmap(titleIcon);
		m_titleIcon->setFixedSize(16, 16);
		m_titleIcon->setScaledContents(true);
		m_closeBtn->setBtnBackground(QString(":/control/close"));
		m_closeBtn->setToolTip(QStringLiteral("关闭"));

		m_titleText->setFixedHeight(30);
		m_titleText->setStyleSheet("color: rgb(239, 239, 239); font-size:12px;");

		title_layout->addWidget(m_titleIcon, 0, Qt::AlignVCenter);
		title_layout->addWidget(m_titleText, 0, Qt::AlignVCenter);
		title_layout->addStretch();
		title_layout->addWidget(m_closeBtn, 0, Qt::AlignRight | Qt::AlignTop);
		title_layout->setSpacing(5);
		title_layout->setContentsMargins(10, 5, 5, 20);

		m_tipsIcon = new QLabel(this);
		m_tipsIcon->setFixedSize(45, 45);
		m_tipsIcon->setScaledContents(true);

		m_tipsText = new QLabel(this);
		m_tipsText->setWordWrap(true);
		m_tipsText->setStyleSheet("color: rgb(231, 231, 231); font-size: 11px;");

		center_layout->addWidget(m_tipsIcon);
		center_layout->addWidget(m_tipsText);
		center_layout->setSpacing(10);
		center_layout->setContentsMargins(15, 0, 15, 0);

		m_okBtn->setFixedSize(60, 25);
		m_cancelBtn->setFixedSize(60, 25);
		m_okBtn->setObjectName("panelBtn");
		m_cancelBtn->setObjectName("panelBtn");

		bottom_layout->addStretch();
		bottom_layout->addWidget(m_okBtn);
		bottom_layout->addWidget(m_cancelBtn);
		bottom_layout->setSpacing(10);
		bottom_layout->setContentsMargins(0, 0, 10, 10);

		main_layout->addLayout(title_layout);
		main_layout->addLayout(center_layout);
		main_layout->addStretch();
		main_layout->addLayout(bottom_layout);
		main_layout->setSpacing(0);
		main_layout->setContentsMargins(5, 5, 5, 5);

		setLayout(main_layout);

		connect(m_okBtn, SIGNAL(clicked()), this, SLOT(okOperate()));
		connect(m_closeBtn, SIGNAL(clicked()), this, SLOT(cancelOperate()));
		connect(m_cancelBtn, SIGNAL(clicked()), this, SLOT(cancelOperate()));
	}

	CMessageBox::~CMessageBox()
	{

	}

	void CMessageBox::setInformation(const QString& title, const QString& info, QPixmap tipsIcon)
	{
		m_titleText->setText(title);
		m_tipsText->setText(info);
		m_tipsIcon->setPixmap(tipsIcon);
	}

	void CMessageBox::paintEvent(QPaintEvent *event)
	{
		ShadowWindow::paintEvent(event);
	}

	void CMessageBox::okOperate()
	{
		accept();
	}

	void CMessageBox::cancelOperate()
	{
		reject();
	}
}
